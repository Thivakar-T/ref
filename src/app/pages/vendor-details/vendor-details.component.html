<div class="container mt-2">
    <div class="row d-flex justify-content-between">
        <div class="col-xl-6">
            <div class="mt-3 mb-3">
                <h2 class="fw-bold">Add vendor</h2>
            </div>
        </div>
        <div class="col-xl-6 ">
            <div class="text-end mt-3 mb-3">
                <div><button type="button" class="btn-blue" routerLink='/dashboard/vendorList'>
                        Vendors
                    </button>
                </div>
            </div>
        </div>
    </div>


    <div class="row d-flex justify-content-between">
        <form [formGroup]="vendorForm" (ngSubmit)="getVendor()">
            <div class="row mb-4">
                <div class="col-xl-4">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Company name *" id="companyName"
                            formControlName="companyName" required [(ngModel)]="vendorObj.companyName"
                            [ngClass]="{ 'is-invalid': submitted && f['companyName'].errors || f['companyName'].touched && f['companyName'].errors }" />
                        <div *ngIf="submitted && f['companyName'].errors || f['companyName'].touched && f['companyName'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['companyName'].errors['required']">Companay name is required
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Name *" id="vendorName"
                            formControlName="vendorName" required [(ngModel)]="vendorObj.vendorName"
                            [ngClass]="{ 'is-invalid': submitted && f['vendorName'].errors || f['vendorName'].touched && f['vendorName'].errors }" />
                        <div *ngIf="submitted && f['vendorName'].errors || f['vendorName'].touched && f['vendorName'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['vendorName'].errors['required']">Name is required
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4">
                    <div class="form-group">
                        <input type="number" class="form-control" placeholder="Phone number *" id="vendorPhoneno"
                            formControlName="vendorPhoneno" [(ngModel)]="vendorObj.vendorPhoneno"
                            [ngClass]="{ 'is-invalid': submitted && f['vendorPhoneno'].errors || f['vendorPhoneno'].touched && f['vendorPhoneno'].errors }">
                        <div *ngIf="submitted && f['vendorPhoneno'].errors  ||f['vendorPhoneno'].touched&&f['vendorPhoneno'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['vendorPhoneno'].errors['required']">Phone number is required
                            </div>
                            <div *ngIf="f['vendorPhoneno'].errors['pattern']">Phone number must contain 10 charaters
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-xl-4">
                    <div class="form-group">
                        <input type="email" class="form-control" placeholder="Email *" id="vendorEmail"
                            formControlName="vendorEmail" required [(ngModel)]="vendorObj.vendorEmail"
                            [ngClass]="{ 'is-invalid': submitted && f['vendorEmail'].errors  ||f['vendorEmail'].touched&&f['vendorEmail'].errors }">
                        <div *ngIf="submitted && f['vendorEmail'].errors  ||f['vendorEmail'].touched&&f['vendorEmail'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['vendorEmail'].errors['required']">Email is required
                            </div>
                            <div *ngIf="f['vendorEmail'].errors['vendorEmail']">Give valid email address
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4">
                    <div class="form-group">
                        <textarea type="text" class="form-control" placeholder="Address 1 *" id="vendorAddress1"
                            formControlName="vendorAddress1" required [(ngModel)]="vendorObj.vendorAddress1"
                            [ngClass]="{ 'is-invalid': submitted && f['vendorAddress1'].errors || f['vendorAddress1'].touched && f['vendorAddress1'].errors }"></textarea>
                        <div *ngIf="submitted && f['vendorAddress1'].errors || f['vendorAddress1'].touched && f['vendorAddress1'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['vendorAddress1'].errors['required']">Address 1 is required
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4">
                    <div class="form-group">
                        <textarea type="text" class="form-control" placeholder="Address 2 *" id="vendorAddress2"
                            formControlName="vendorAddress2" required [(ngModel)]="vendorObj.vendorAddress2"
                            [ngClass]="{ 'is-invalid': submitted && f['vendorAddress2'].errors || f['vendorAddress2'].touched && f['vendorAddress2'].errors }"></textarea>
                        <div *ngIf="submitted && f['vendorAddress2'].errors || f['vendorAddress2'].touched && f['vendorAddress2'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['vendorAddress2'].errors['required']">Address 2 is required
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-xl-4">
                    <div class="form-group">
                        <ng-select [items]='countryArr' name="countryName" id="productname" bindLabel="countryName"
                            bindValue="id" placeholder="Country *" formControlName="vendorCountryId" class="country"
                            id="vendorCountryId" (change)='getState($event.id)' [(ngModel)]="vendorObj.vendorCountryId"
                            [ngClass]="{ 'is-invalid': submitted && f['vendorCountryId'].errors || f['vendorCountryId'].touched && f['vendorCountryId'].errors }">
                        </ng-select>
                        <div *ngIf="submitted && f['vendorCountryId'].errors || f['vendorCountryId'].touched && f['vendorCountryId'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['vendorCountryId'].errors['required']">Country is required</div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4">
                    <div class="form-group">
                        <ng-select [items]='stateList' name="id" bindLabel="name" bindValue="id"
                            (change)='getCity($event.id)' placeholder="State *" formControlName="vendorStateId"
                            class="state" [(ngModel)]="vendorObj.vendorStateId" [(ngModel)]="countryArr.vendorStateId"
                            [ngClass]="{ 'is-invalid': submitted && f['vendorStateId'].errors || f['vendorStateId'].touched && f['vendorStateId'].errors }">
                        </ng-select>
                        <div *ngIf="submitted && f['vendorStateId'].errors || f['vendorStateId'].touched && f['vendorStateId'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['vendorStateId'].errors['required']">State is required</div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4">
                    <div class="form-group">
                        <ng-select [items]='cityList' id="productname" bindLabel="name" bindValue="id"
                            placeholder="City *" formControlName="vendorCityId" [(ngModel)]="vendorObj.vendorCityId"
                            [ngClass]="{ 'is-invalid': submitted && f['vendorCityId'].errors || f['vendorCityId'].touched && f['vendorCityId'].errors }">
                        </ng-select>
                        <div *ngIf="submitted && f['vendorCityId'].errors || f['vendorCityId'].touched && f['vendorCityId'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['vendorCityId'].errors['required']">City is required</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-xl-4">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="PIN code *" id="pinCode"
                            formControlName="pinCode" required [(ngModel)]="vendorObj.pinCode"
                            [ngClass]="{ 'is-invalid': submitted && f['pinCode'].errors || f['pinCode'].touched && f['pinCode'].errors }">
                        <div *ngIf="submitted && f['pinCode'].errors || f['pinCode'].touched && f['pinCode'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['pinCode'].errors['required']">PIN code is required
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Discription" id="description"
                            formControlName="description" required [(ngModel)]="vendorObj.description"
                            [ngClass]="{ 'is-invalid': submitted && f['description'].errors || f['description'].touched && f['description'].errors }">
                        <div *ngIf="submitted && f['description'].errors || f['description'].touched && f['description'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['description'].errors['required']">Discription is required
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="GST" id="gstIn" formControlName="gstIn"
                            required [(ngModel)]="vendorObj.gstIn"
                            [ngClass]="{ 'is-invalid': submitted && f['gstIn'].errors || f['gstIn'].touched && f['gstIn'].errors }">
                        <div *ngIf="submitted && f['gstIn'].errors || f['gstIn'].touched && f['gstIn'].errors"
                            class="invalid-feedback">
                            <div *ngIf="f['gstIn'].errors['required']">GST is required
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mb-4">
                <div class="form-group">
                    <input type="hidden" class="form-control" placeholder="id" id="id" formControlName="id" required
                        [(ngModel)]="vendorObj.id"
                        [ngClass]="{ 'is-invalid': submitted && f['id'].errors || f['id'].touched && f['id'].errors }">
                    <div *ngIf="submitted && f['id'].errors || f['id'].touched && f['id'].errors"
                        class="invalid-feedback">
                        <div *ngIf="f['id'].errors['required']">
                        </div>
                    </div>
                </div>
            </div>



            <div class="row d-flex justify-content-between">
                <div class="col">
                    <div class="text-end mb-0 float-end">
                        <div><button type="button" class="btn btn-success btn-sm mt-3 mb-5" (click)="addItem()">
                                <i class="mdi mdi-plus mr-1"></i> Order Material
                            </button>
                        </div>
                    </div>
                </div>
                <div class="card-body table-responsive" formArrayName="materialList">
                    <table id="emplist" class="table table-striped" style="width:100%">
                        <thead>
                            <tr>
                                <th scope="col">S.No</th>
                                <th scope="col">Material name</th>
                                <th scope="col">Description</th>
                                <th scope="col">Action</th>
                            </tr>
                        </thead>
                        <tbody id="tbody">
                            <tr *ngFor="let vendor of materialListAr.controls; let i = index" [formGroupName]="i">
                                <td>{{i+1}}</td>
                                <td>
                                    <div class="form-group">
                                        <span *ngFor="let mat of matArr"></span>
                                        <ng-select [items]='vendors' bindLabel="name" bindValue="id"
                                            placeholder="Choose the material name" formControlName="materialId">
                                        </ng-select>
                                        <!-- <div *ngIf="submitted && f['vendorCountryId'].errors || f['vendorCountryId'].touched && f['vendorCountryId'].errors"
                                                class="invalid-feedback">
                                                <div *ngIf="f['vendorCountryId'].errors['required']">Material Name is required</div>
                                            </div> -->
                                    </div>
                                </td>
                                <td><input class="form-control" placeholder="Descrition"
                                        formControlName="description" /></td>

                                <td (click)="delete(i)">
                                    <mat-icon class="text-danger mt-1">delete</mat-icon>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="d-flex justify-content-end gap-4">
                <button type="reset" class="btn btn-danger mb-3 float-end px-4">Cancel</button>
                <button type="submit" class="btn-blue mb-3 float-end px-4" id="">Submit</button>
            </div>
        </form>
    </div>
</div>